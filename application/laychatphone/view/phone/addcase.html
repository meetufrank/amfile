<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>国际医疗健康顾问</title>
    <link rel="stylesheet" href="__PHONE__/case/mui/mui.min.css">
    <link rel="stylesheet" href="__PHONE__/case/css/base.css">
    <!--日期控件-->
    <link rel="stylesheet" href="__PHONE__/case/css/mobileSelect.css">
    <script src="__PHONE__/case/js/rem.js"></script>
    <link rel="stylesheet" href="__PHONE__/case/css/health.css">
    <link rel="stylesheet" href="__PHONE__/case/css/health_two.css">
    {if condition="$typeid eq 2"}
    <style>
        .content2{
            display: none;
        }
    </style>
    {/if}
</head>
<body>
    <!--title-->
    
    <form class="medical-form  form-horizontal" role="form" id="caseform">
    {if condition="$typeid eq 2"}
    <!--menu-->
    <div class="header">
        <div class="header_left">
            <span class="mui-icon mui-icon-back"  ></span>
        </div>
        <div class="header_center">
            <p>{$title}</p>
        </div>
        <div class="header_right">
            <p>&nbsp;</p>
        </div>
    </div>
    <div class="menu">
        <ul>
            <li class="active">问卷调查</li>
            <li>信息填写</li>
        </ul>
    </div>

    <!--part1-->
    <div class="content1">
        <!--content-->
        <div class="content">
            <!--单独的-->
            <div class="content_only">
                <p class="question_name">1.您需要下述哪种心理支持？</p>
                <div class="question_option">
                    {volist name="xinlilist" id="cl"}
                    <p><input type="radio" name="xinli_help" id="xl{$cl['value']}" value="{$cl['value']}" ><label for="xl{$cl['value']}">{$cl['name']}</label></p>
                    {/volist}
                </div>
            </div>
            <!--多选块-->
            <div class="content_only">
                <p class="question_name">2.您是否有情绪问题（心情困扰）？</p>
                <div class="question_option">
                    <ul>
                        {volist name="qingxulist" id="cl"}
                          {if condition="$cl['value'] eq 999"}
                              <li><input type="checkbox" name="qingxu_help[]" value="{$cl['value']}" class="other"><label for="{$cl['value']}">{$cl['name']}</label><input type="text" name="qingxu_other" class="other_input" value readonly="readonly"> <span>请描述</span></li>
                              
                          {else}
                              <li><input type="checkbox" name="qingxu_help[]" value="{$cl['value']}"><label for="{$cl['value']}">{$cl['name']}</label></li>
                          {/if}
                        
                        {/volist}
                   
                        
                    </ul>
                    <div style="clear: both;"></div>
                </div>
            </div>

            <!--单独的-->
            <div class="content_only">
                <p class="question_name">3.您是否有伤害自己的想法？</p>
                <div class="question_option">
                    {volist name="shanghailist" id="cl"}
                     <p><input type="radio" name="shanghai_help" id="sh{$cl['value']}" value="{$cl['value']}" ><label for="sh{$cl['value']}" >{$cl['name']}</label></p>
                    {/volist}
                </div>
            </div>
            <!--单独的-->
            <div class="content_only">
                <p class="question_name">4.您是否有长期的身体疼痛或者其他症状？</p>
                <div class="question_option">
                    <p><input type="radio" name="3" id="yes" value="是" class="yes_button"><label for="yes">是</label><input type="text"class="describe" name="shenti_content" value  readonly="readonly" > <span>请描述</span> </p>
                    <p><input type="radio" name="3" id="no" value="否" checked class="no_button"><label for="no">否</label></p>
                </div>
            </div>
            <!--单独的-->
            <div class="content_only">
                <p class="question_name">5.您是否有在吃药？</p>
                <div class="question_option">
                    <p><input type="radio" name="4" id="yes1" class="yes_button"><label for="yes1">是</label><input type="text" class="describe" name="yaowu_help" value readonly="readonly"> <span>请描述</span> </p>
                    <p><input type="radio" name="4" id="no1" checked class="no_button"><label for="no1">否</label></p>
                </div> 
            </div>
            <!--单独的-->
            <div class="content_only">
                <p class="question_name">6.您是之前做过心理咨询？</p>
                <div class="question_option">
                    <p><input type="radio" name="5" id="shi" class="yes_button" ><label for="shi">是</label><input type="text" class="describe" name="before_xinli"  value readonly="readonly"> <span>请描述</span> </p>
                    <p><input type="radio" name="5" id="fou" checked  class="no_button"><label for="fou">否</label></p>
                </div>
            </div>
        </div>
        <!--下一步    -->
        <div class="next_btn">
            <a href="javascript:void(0);">下一步</a>
        </div>
    </div>
   {else} 
    <div class="header">
        <div class="header_left" style="width: 18%;">
            <span class="mui-icon mui-icon-back" onclick="javascript:history.go(-1)"></span>
        </div>
        <div class="header_center">
            <p>{$title}</p>
        </div>
        <div class="header_right" style="width: 18%;">
            <p>&nbsp;</p>
        </div>
    </div>
    <!--menu-->
    <div class="menu">
        <ul>
            <!--<li>问卷调查</li>-->
            <li class="active" style="width: 100%;">信息填写</li>
        </ul>
    </div>
    {if condition="$typeid eq 4"}
    <div class="tap">
        <div class="bgColor"><!-- 背景遮罩 --></div>
        <img src="__PHONE__/case/images/emo.jpg" alt="">
    </div>
    {/if}
   {/if}
    <!--part2-->

    <div class="content2">

        <div class="contentT">
            <input type="hidden"  name="case_type" value="{$typeid}">
            <input type="hidden"  name="country" value="1">
            <input type="hidden"  name="preferred_time" value="">
            <input type="hidden"  name="isme" value="1">
            <input type="hidden"  name="applicant_name" value="">
            {if condition="$typeid eq 4"}
            <div class="content_title">病案号</div>
            <div class="tc">
                <input type="text" placeholder="医学专家意见服务病案号(见专家意见报告首页)" class="emo" name="record_number">
                <div style="text-align: right;" class="findRight">
                    <a href="javascript:void(0);" class="howFind">如何找到病案号？</a>
                </div>

            </div>
            {/if}
            <!--title-->
            <div class="content_title">申请人信息</div>
            <!--表单部分-->
            <div class="tc">
                <input type="text" placeholder="姓名" class="name" name="username">
                <div class="pr">
                    <input type="text" readonly="readonly" id="trigger1" class="birth" placeholder="出生日期" name="birthday">
                    <img src="__PHONE__/case/images/birth.png" alt="" class="bir">
                </div>

                <!--患者性别-->
                <div class="df">
                    <p>患者性别</p>
                    <div>
                        <input type="radio" name="sex" value="1" id="yess" checked><label for="yess">男</label>
                        <input type="radio" name="sex" value="0" id="noo"><label for="noo">女</label>
                    </div>
                </div>
                <input type="text" placeholder="电话" class="phone" name="preferred_phone">
                <input type="text" placeholder="E-mail" class="mail" name="email">
                <div class="pr df">
                    <!--<input type="text" placeholder="所在省市区" readonly="readonly" id="expressArea">-->

                    <div class="choose_add">
                        <!--省-->
                        <select id="province" name="province">
                            <option value="省">省</option>
                            {volist name="area" id="vo"}
                             <option  value="{$vo['id']}" >{$vo['area_name']}</option>
                             {/volist}
                        </select>
                    </div>

                    <div class="choose_add">
                        <!--市-->
                        <select id="city" name="city">
                            <option value="市">市</option>
                        </select>
                    </div>

                    <div class="choose_add">
                        <!--区-->
                        <select id="district" name="district">
                            <option value="区">区</option>
                        </select>
                    </div>

                    <!--<select name="" id="">-->
                    <!--<option value=""></option>-->
                    <!--</select>-->
                    <!--<img src="images/down.png" alt="" class="down">-->
                </div>
                <div class="pr">
                    <!--<input type="text" placeholder="请选择服务语言" readonly="readonly">-->
                    <select name="service_lang" id="sele">
                        <option value="0">请选择服务语言</option>
                        {volist name="case_service_list" id="cl"}
                        <option  value="{$cl['value']}" >{$cl['name']}</option>
                        {/volist}
                    </select>
                    <img src="__PHONE__/case/images/down.png" alt="" class="down" style="pointer-events: none;">

                </div>

                <!--偏好联络方式-->
                <div class="df mb">
                    <p>偏好的联络方式</p>
                    <div>
                        <input type="radio" name="sx_lxfs" id="phone" value="1" checked><label for="phone">电话</label>
                        <input type="radio" name="sx_lxfs" id="mail" value="2"><label for="mail">邮箱</label>
                    </div>
                </div>
                <div class="content_title">请说明您（或患者）的病情和需求</div>
                <!--testarea-->
                <div class="test mb">
                    <textarea class="info" name="illness"></textarea>
                </div>
                <div class="content_title">方便联络的时间</div>
                <div class="select_time">
                    <ul>
                        <li>9:00-12:00</li>
                        <li>12:00-15:00</li>
                        <li>15:00-18:00</li>
                        <li>18:00-21:00</li>
                        <div style="clear: both;"></div>
                    </ul>
                    <input type="text" placeholder="请输入指定的时间" name="other_time">
                </div>
                <!--上传文件-->
                <div style="width: 5.56rem; margin: 0 auto; text-align: left;">
                    <input type="file" class="file_no" id="fileField" name="upload_file">
                    <span class="file_cli">选择文件</span> <span class="file_name" id="upload_result"></span>
                </div>
            </div>
        </div>
        <!--免责声明-->
        <div class="terms">
            <input type="checkbox" name="33"><label for="">我同意下述&nbsp;<a href="{:url(\'Phone/ruleservice\',array(\'id\'=>$typeid))}">免责声明和服务条款</a></label>
        </div>
        <!--提交按钮-->
        <div class="sub_btn">
            <a href="javascript:;" id="casesubmit">提交</a>
        </div>

    </div>
    </form>

    <script src="__PHONE__/case/js/jquery.min.js"></script>
    <script src="__PHONE__/case/layui/layui.all.js"></script>
    <!--日期控件-->
    <script src="__PHONE__/case/js/mobileSelect.js"></script>
    <!--日期控件-->
    <script>
       
       
       $("[name='username']").change(function(){
		$("[name='applicant_name']").val($(this).val());
               
	})
       
       // 上传文件
	$('#fileField').on('change', function(){
		
		var uploadFile = $(this).get(0).files[0];
		
                
		if(typeof uploadFile == 'undefined'){
			return false;
		}
		
		var formData = new FormData();
		
		formData.append('upload_file', uploadFile);
		var ajaxOption = {
			url 	: '{:url("advance/Upload/upload")}',
			type	: 'post',
			data	: formData,
			dataType: 'json',
			timeout	: 0,
			processData : false,
			contentType : false,
			success	: function(res){
				
				if(res.code == 1){
					$('#upload_result').html(uploadFile.name);
				       $('#upload_file').before('<input type="hidden" value="'+res.data.url+'" name="options"/>');
				}else{
					$('#upload_result').html('<span >['+res.msg+']</span>');
				}
			},
			error : function(xhr){
				
				$('#upload_result').html('<span >[网络链接错误]</span>');
			}
		};
		$.ajax(ajaxOption);
	});
       
       
       function getcity(id){
          		var current_province_id=id;
                  
		
		$.ajax({
			url:"{:url('@module/cases/Interfaces/getCity')}",
			data:{ParentId:current_province_id},
			dataType:'json',
			type:'post',
                        async: false,
			success:function(re){
				var html='<option value="0">请选择</option>';
                                $("[name='district']").html(html);
				var item=re.data;
				for(var i in item){
					html +='<option value="'+item[i]['id']+'" >'+item[i]['area_name']+'</option>';
				}
				$("[name='city']").html(html);
                                
			}
		})
      }
      
      
      function getdistrict(id){
          		var current_city=id;
		$.ajax({
			url:"{:url('@module/cases/Interfaces/getDistrict')}",
			data:{ParentId:current_city},
			dataType:'json',
			type:'post',
			success:function(re){
				var html='<option value="0">请选择</option>';
				var item=re.data;
				for(var i in item){
					html +='<option value="'+item[i]['id']+'" >'+item[i]['area_name']+'</option>';
				}
				$("[name='district']").html(html);
			}
		})
      }
      	$("[name='province']").change(function(){
		$("[name='city']").html('<option value="0">请选择</option>');
                getcity($(this).val());
                $("[name='district']").val();
	})
	$("[name='city']").change(function(){
		$("[name='district']").html('<option value="0">请选择</option>');

                getdistrict($(this).val());
	})
	var pro_id=$("[name='province']").val();
        if(pro_id>0){
            $("[name='city']").html('<option value="0">请选择</option>');
            getcity($("[name='province']").val());
            $("[name='district']").html('<option value="0">请选择</option>');
            getdistrict($("[name='province']").val());
        }


        // 日期选择
        var years=[];
        var month=[];
        var day=[];
        var myDate = new Date();
        myDate.getFullYear();    //获取完整的年份(4位,1970-????)
        myDate.getMonth();       //获取当前月份(0-11,0代表1月)
        myDate.getDate();
        var _data=[];
        for(i=0; i<myDate.getFullYear()-1960; i++){
            //年
            var obj={};
            var yer=1960+i+1;
            obj.value=1960+i+1;
            var _data2=[];
            for(n=0; n<12; n++){
                //月
                var obj2={};
                if(n<9){
                    obj2.value='0'+(n+1);
                }else{
                    obj2.value=n+1;
                }
                var _data3=[];
                if(n==1){
                    var cond1 = yer % 4 == 0;  //条件1：年份必须要能被4整除
                    var cond2 = yer % 100 != 0;  //条件2：年份不能是整百数
                    var cond3 = yer % 400 ==0;
                    var cond = cond1 && cond2 || cond3;
                    //闰年
                    if(cond){
                        for(y=0; y<29; y++){
                            //日
                            var obj3={};
                            if(y<9){
                                obj3.value='0'+(y+1);
                            }else{
                                obj3.value=y+1;
                            }
                            _data3.push(obj3)
                        }
                    }else{
                        for(y=0; y<28; y++){
                            //日
                            var obj3={};
                            if(y<9){
                                obj3.value='0'+(y+1);
                            }else{
                                obj3.value=y+1;
                            }
                            _data3.push(obj3)
                        }
                    }
                }else if(n==0||n==2||n==4||n==6||n==7||n==9||n==11){
                    for(y=0; y<31; y++){
                        //日
                        var obj3={};
                        if(y<9){
                            obj3.value='0'+(y+1);
                        }else{
                            obj3.value=y+1;
                        }
                        _data3.push(obj3)
                    }
                }else{
                    for(y=0; y<30; y++){
                        //日
                        var obj3={};
                        if(y<9){
                            obj3.value='0'+(y+1);
                        }else{
                            obj3.value=y+1;
                        }
                        _data3.push(obj3)
                    }
                }
                obj2.childs=_data3;
                _data2.push(obj2);
            }
            obj.childs=_data2;
            _data.push(obj)
        }
        var mobileSelect1 = new MobileSelect({
            trigger: '#trigger1',
            title: '日期选择',
            wheels: [
                {data:_data}
            ],
            transitionEnd:function(indexArr, data){
               // console.log(data);
            },
            callback:function(indexArr, data){
                //console.log(data);
                 $("#trigger1").val(data[0].value+'-'+data[1].value+'-'+data[2].value);

//                $("#trigger1").val(data[2].value+' / '+data[1].value+' / '+data[0].value);
            }
        });
    </script>
    <script>
        $(".file_cli").click(function(){
            $(".file_no").click();
//            var lj = document.getElementById('fileField').files[0].name;
//            $(".file_name").html(lj);
        });

        $(function(){   //  part1
            // 复选框部分
            $(".other").click(function(){
                var $this = $(this);
                if($this.is(":checked")){
                    $(this).siblings(".other_input").removeAttr("readonly");
                    $(this).siblings(".other_input").css("background","transparent");
                    $(this).siblings("span").hide();
                }else{
                    $(".other_input").attr("readonly","readonly");
                    $(".other_input").css("background","#f2f3f6");
                    $(this).siblings("span").show();
                }

//                var radio1= $('input:radio[name="1"]:checked').val();
//                var radio2= $('input:radio[name="2"]:checked').val();
//                var radio3= $('input:radio[name="3"]:checked').val();
//                var radio4= $('input:radio[name="4"]:checked').val();
//                var radio5= $('input:radio[name="5"]:checked').val();
//               var check = $('input:checkbox[name="box"]:checked').val();
//               if(radio1!=null && radio2!=null && radio3!=null && radio4!=null && radio5!=null && check!=null){
//                  
//                    $(".next_btn a").css("background","#008fff");
//                }
                $(".next_btn a").css("background","#008fff");
            });


            $(".next_btn a").css("background","#008fff");  //无需验证
            // 单选框部分
            $(".yes_button").click(function(){
                var $this = $(this);
                $this.siblings(".describe").removeAttr("readonly");
                $this.siblings(".describe").css("background","transparent");
                $this.siblings("span").hide();

//                var radio1= $('input:radio[name="1"]:checked').val();
//                var radio2= $('input:radio[name="2"]:checked').val();
//                var radio3= $('input:radio[name="3"]:checked').val();
//                var radio4= $('input:radio[name="4"]:checked').val();
//                var radio5= $('input:radio[name="5"]:checked').val();
//                var check = $('input:checkbox[name="box"]:checked').val();
//                if(radio1!=null && radio2!=null && radio3!=null && radio4!=null && radio5!=null && check!=null){
//                    $(".next_btn a").css("background","#008fff");
//                }
               
            });
            $(".no_button").click(function(){
                var $this = $(this);
                $this.parent().siblings().find(".describe").attr("readonly","readonly");
                $this.parent().siblings().find(".describe").css("background","#f2f3f6");
                $this.parent().siblings().find("span").hide();


               
//                var radio1= $('input:radio[name="1"]:checked').val();
//                var radio2= $('input:radio[name="2"]:checked').val();
//                var radio3= $('input:radio[name="3"]:checked').val();
//                var radio4= $('input:radio[name="4"]:checked').val();
//                var radio5= $('input:radio[name="5"]:checked').val();
//                var check = $('input:checkbox[name="box"]:checked').val();
//                if(radio1!=null && radio2!=null && radio3!=null && radio4!=null && radio5!=null && check!=null){
//                    $(".next_btn a").css("background","#008fff");
//                }
            });

//            $("#yes1").click(function(){
//                var $this = $(this);
//                $this.siblings(".describe").removeAttr("readonly");
//                $this.siblings(".describe").css("background","transparent");
//                $this.siblings("span").hide();
//
//                var radio1= $('input:radio[name="1"]:checked').val();
//                var radio2= $('input:radio[name="2"]:checked').val();
//                var radio3= $('input:radio[name="3"]:checked').val();
//                var radio4= $('input:radio[name="4"]:checked').val();
//                var radio5= $('input:radio[name="5"]:checked').val();
//                var check = $('input:checkbox[name="box"]:checked').val();
//                if(radio1!=null && radio2!=null && radio3!=null && radio4!=null && radio5!=null && check!=null){
//                    $(".next_btn a").css("background","#008fff");
//                }
//            });
//            $("#no1").click(function(){
//                var $this = $(this);
//                $this.parent().siblings().find(".describe").attr("readonly","readonly");
//                $this.parent().siblings().find(".describe").css("background","#f2f3f6");
//                $this.parent().siblings().find("span").hide();
//
//                var radio1= $('input:radio[name="1"]:checked').val();
//                var radio2= $('input:radio[name="2"]:checked').val();
//                var radio3= $('input:radio[name="3"]:checked').val();
//                var radio4= $('input:radio[name="4"]:checked').val();
//                var radio5= $('input:radio[name="5"]:checked').val();
//                var check = $('input:checkbox[name="box"]:checked').val();
//                if(radio1!=null && radio2!=null && radio3!=null && radio4!=null && radio5!=null && check!=null){
//                    $(".next_btn a").css("background","#008fff");
//                }
//            });
//
//            $("#shi").click(function(){
//                var $this = $(this);
//                $this.siblings(".describe").removeAttr("readonly");
//                $this.siblings(".describe").css("background","transparent");
//                $this.siblings("span").hide();
//
//                var radio1= $('input:radio[name="1"]:checked').val();
//                var radio2= $('input:radio[name="2"]:checked').val();
//                var radio3= $('input:radio[name="3"]:checked').val();
//                var radio4= $('input:radio[name="4"]:checked').val();
//                var radio5= $('input:radio[name="5"]:checked').val();
//                var check = $('input:checkbox[name="box"]:checked').val();
//                if(radio1!=null && radio2!=null && radio3!=null && radio4!=null && radio5!=null && check!=null){
//                    $(".next_btn a").css("background","#008fff");
//                }
//            });
//            $("#fou").click(function(){
//                var $this = $(this);
//                $this.parent().siblings().find(".describe").attr("readonly","readonly");
//                $this.parent().siblings().find(".describe").css("background","#f2f3f6");
//                $this.parent().siblings().find("span").hide();
//
//                var radio1= $('input:radio[name="1"]:checked').val();
//                var radio2= $('input:radio[name="2"]:checked').val();
//                var radio3= $('input:radio[name="3"]:checked').val();
//                var radio4= $('input:radio[name="4"]:checked').val();
//                var radio5= $('input:radio[name="5"]:checked').val();
//                var check = $('input:checkbox[name="box"]:checked').val();
//                if(radio1!=null && radio2!=null && radio3!=null && radio4!=null && radio5!=null && check!=null){
//                    $(".next_btn a").css("background","#008fff");
//                }
//            });



            $(".next_btn").on('click','a',function(){
                    // 获取 name=3 的input 并获取他的value值   (点击下一步时的验证)
//                    var radio1= $('input:radio[name="1"]:checked').val();
//                    var radio2= $('input:radio[name="2"]:checked').val();
//                    var radio3= $('input:radio[name="3"]:checked').val();
//                    var radio4= $('input:radio[name="4"]:checked').val();
//                    var radio5= $('input:radio[name="5"]:checked').val();
//
//                    var check = $('input:checkbox[name="box"]:checked').val();
//                    // alert(check);
//
//                    if(radio1==null || radio2==null || radio3==null || radio4==null || radio5==null || check==null){
//                        layer.msg("请填写完整内容");
//                        $(".next_btn a").css("background","#c6c6d3");
//                        return false;
//                    }else{
//
//                        $(".next_btn a").css("background","#008fff");
//
//                        $(".content1").hide();
//                        $(".content2").show();
//
//                        $(".menu li:last-child").addClass("active").siblings().removeClass("active");
//
//                    }
                    
                    
                    $(".next_btn a").css("background","#008fff");

                        $(".content1").hide();
                        $(".content2").show();

                        $(".menu li:last-child").addClass("active").siblings().removeClass("active");
            });
        });

        $(".mui-icon-back").click(function(){
            if($(".content1").is(':hidden')){
                $(".content1").show();
                $(".content2").hide();
                $(".menu li:last-child").removeClass("active").siblings().addClass("active");
            }else{
                window.history.go(-1);
            }
            
        });

        $(function(){   //  part2
            $(".select_time").on('click','li',function(){
                var $this = $(this);
                if(!$this.hasClass("active")){
                    $this.addClass("active");
                }else{
                    $this.removeClass("active");
                }
                
                //整合active的li的html
                var timestr='';
                $.each($(".select_time ul li"),function(i){
                    if($(this).hasClass("active")){
                        timestr+=$(this).text()+'  ';
                    }
                });
                
                
                $("input[name='preferred_time']").val(timestr);
                
            });
            $(".down").click(function () {
                $("#sele").prev().click();
            });

            // 点击提交
            $(".sub_btn a").click(function(){
                var $name = $(".name").val();
                var $birth = $(".birth").val();
                var val=$('input:radio[name="sex"]:checked').val();
                var $phone = $(".phone").val();
                var $mail = $(".mail").val();
                var regEm = /^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/;
                var $expressArea = $("#expressArea").val();
                var val1=$('input:radio[name="sx_lxfs"]:checked').val();
                var $info = $(".info").val();
                var val3=$('input:checkbox[name="33"]:checked').val();

                if($name == ""){
                    layer.msg("姓名不能为空");
                    return false;
                }else if($birth == ""){
                    layer.msg("请选择出生日期");
                    return false;
                }else if(val==null){
                    layer.msg("请选择你的性别");
                    return false;
                }else if($phone == ""){
                    layer.msg("电话号不能为空");
                    return false;
                }else  if(!(/^1[3456789]\d{9}$/.test($phone))){
                    layer.msg("请输入正确的手机号");
                    return false;
                }else if($mail == ""){
                    layer.msg("邮箱不能为空");
                    return false;
                }else if(!regEm.test($mail)){
                    layer.msg("请输入正确的邮箱");
                    return false;
                }else if($expressArea == ""){
                    layer.msg("省市区不能为空");
                    return false;
                }else  if(val1==null){
                    layer.msg("请选择偏好的联络方式");
                    return false;
                }else if($info == ""){
                    layer.msg("病情需求不能为空");
                    return false;
                }else if(val3==null){
                    layer.msg("请阅读并勾选免责声明");
                    return false;
                }
                
                
                 var valarray= $("#caseform").serializeArray();
                $.each(valarray,function(i){
                    
                    if(valarray[i].name=='preferred_time'){
                        valarray[i].value+=$("input[name='other_time']").val();
                    }
                   
                })
                
                    $.ajax({
                    url: '{:url(\'advance/Index/addCase\')}',
                    type: "POST",
                    data: valarray,
                    success: function(data) {

                        if(data.code==1){
                           
                             
                             layer.msg('提交成功', {
                                  icon: 1,
                                  time: 2000 //2秒关闭（如果不配置，默认是3秒）
                                }, function(){
                                  window.location.href='{:url(\'Phone/case_list\')}';
                                })
                        }else{
                            if(data.msg.error==2){
                                window.location.href='{:url(\'/service\')}';
                            }else{
                                layer.msg(data.msg.msg);
                            }


                        }

                    }
                })
            });
        });


$(".howFind").click(function(){
           $(".tap").show(200);
           $("body").css("overflow","hidden");
        });
        $(".bgColor").click(function(){
           $(".tap").fadeOut();
            $("body").css("overflow","auto");
        });


    </script>
</body>
</html>